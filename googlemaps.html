<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0px; padding: 0px }
  #map_canvas { height: 100% }
</style>
<script type="text/javascript"
    src="http://maps.google.com/maps/api/js?sensor=false">
</script>
<script type="text/javascript">
//(44.939066 , -123.029945)
    // Create an object containing LatLng, population.
var http_request;
var myObject = {};
http_request =new XMLHttpRequest();
var url="http://www.oregonvoices.org/schools.json";
http_request.open("GET",url,true);
/*http_request.onreadystatechange = function () {
  if (http_request.readyState == 4 && http_request.status == 200){
       myObject = JSON.parse( http_request.responseText );
       alert("made it");
  }
};
*/
//myObject = JSON.parse(http_request.responseText);
alert(http_request.responseText);
http_request.send(null);
  var citymap = {};
//  citymap['heritage school'] = {
//    center: new google.maps.LatLng(44.899461 , -123.013873),
//  };
  citymap['richmond elementary'] = {
    center: new google.maps.LatLng(44.929567, -123.013363),
    name: 'richmond elementary'
  };
  citymap['court street christian child care'] = {
    center: new google.maps.LatLng(44.936542, -123.019606),
    name: 'court street christian child care',
  };
  citymap['st joseph school'] = {
    center: new google.maps.LatLng(44.941449 , -123.030740),
    name: 'st joseph school',
  }
  var bendmap = {};
  bendmap['Bend Senior High School'] = {
    address: '230 Northeast 6th Street, Bend, OR',
    name: 'Bend Senior High School',
  }
  var centermap;

  var cityCircle;
  var citymarker;
  var geocoder;
  var testmarker;
  var mapmarker;
  var geocoder;

  function initialize() {
    geocoder = new google.maps.Geocoder();
    var mapOptions = {
      zoom: 14,
     // center: new google.maps.LatLng(44.939066 , -123.029945), //salem
      center: new google.maps.LatLng(44.052524,-121.297231 ), //bend
      
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var map = new google.maps.Map(document.getElementById("map_canvas"),
        mapOptions);
        
    for (var school in bendmap) {
      // Construct the circle for each value in citymap. We scale population by 20.
      var georequest = {
        address: bendmap[school].address,
      }
      geocoder.geocode( georequest, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
          var populationOptions = {
            strokeColor: "#FF0000",
            strokeOpacity: 0.8,
            strokeWeight: 2,
            fillColor: "#FF0000",
            fillOpacity: 0.35,
            map: map,
            center: results[0].geometry.location,
            radius: 305,
          };
          cityCircle = new google.maps.Circle(populationOptions);
          citymarker = new google.maps.Marker({
              position: results[0].geometry.location,
              map: map, 
              title: bendmap[school].name
          });  
          } else {
            alert("Geocode was not successful for the following reason: " + status);
          }
    });
    
    }
  }
 

</script>
</head>
<body onload="initialize()">
  <div id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html>
